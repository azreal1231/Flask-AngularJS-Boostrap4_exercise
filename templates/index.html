<!DOCTYPE html>
<html lang="en">
<!-- <link rel="stylesheet" type="text/css" href="./static/style.css"> -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>exercise</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
</head>

<body ng-app="myApp" ng-controller="myCtrl">

    <table class="table table-striped table-dark">
        <tr>
            <th ng-click="chagneOrderBy('name')" > Name </th>
            <th ng-click="chagneOrderBy('cash')" > Cash </th>
            <th ng-click="chagneOrderBy('email')" > Email </th>
            <th ng-click="chagneOrderBy('number')" > Number </th>
            <th ng-click="chagneOrderBy('risk')" > Risk </th>
        </tr>
        <tr ng-repeat="user in users | orderBy:newOrderBy">
            <td>[[ user.name ]]</td>
            <td>[[ user.cash ]]</td>
            <td>[[ user.email ]]</td>
            <td>[[ user.number ]]</td>
            <td>[[ user.risk ]]</td>
        </tr>

    </table>

</body>

</html>




<script>
    //bullshit pain in the ass code I had to add that zara is going to shout at me for FFS
    var app = angular.module('myApp', []).config(['$interpolateProvider', function ($interpolateProvider) {
        $interpolateProvider.startSymbol('[[');
        $interpolateProvider.endSymbol(']]');
    }]);;

    app.factory('GetDataService', ['$http', function ($http) {
        var GetDataService = {};

        GetDataService.Call = function (method, param) {
            return $http({
                method: 'POST',
                url: '/get-data',
                data: ConvertDicToPostString({
                    'de': method,
                    'params': JSON.stringify(param)
                }),
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
            });
        };

        return GetDataService;

        function ConvertDicToPostString(vDic) {
            var Texter = '';
            for (var key in vDic) {
                Texter = Texter + key + '=' + vDic[key] + '&';
            }
            return Texter;
        };
    }]);

    app.controller('myCtrl', function ($scope, $http, GetDataService) {

        $scope.users = [];

        $scope.chagneOrderBy = function(x) {
            $scope.newOrderBy = x
        }

        GetDataService.Call('ReturnUsers', 'AllUsers').then(
            function (_response) {
                $scope.users = _response['data']['Records']
                console.log($scope.users)
                // alert('We have Data!');

            },
            function (_response) {
                alert('Search Error');
            }
        );
    });

</script>